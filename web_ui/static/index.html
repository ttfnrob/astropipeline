<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AstroAgent Pipeline Monitor</title>
    <link rel="stylesheet" href="/static/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                                        <h1><i class="fas fa-rocket"></i> AstroAgent Continuous Research System</h1>
                <div class="header-controls">
                    <!-- Continuous System Control -->
                    <div class="continuous-controls">
                        <div class="run-status" id="run-status">
                            <span class="status-indicator idle" id="status-indicator"></span>
                            <span class="status-text" id="status-text">System Idle</span>
                        </div>
                        <div class="current-stage" id="current-stage-indicator" style="display: none;">
                            <div class="stage-name">System Idle</div>
                        </div>
                        <div class="run-metrics" id="run-metrics" style="display: none;">
                            <span class="metric">Cycle: <span id="current-cycle">0</span></span>
                            <span class="metric">Completed: <span id="completed-count">0</span></span>
                            <span class="metric">Runtime: <span id="runtime-display">00:00:00</span></span>
                        </div>
                        <div class="dropdown">
                            <button id="control-dropdown-btn" class="control-btn primary-btn" title="System Controls">
                                <i class="fas fa-cog"></i> Controls
                            </button>
                            <div class="dropdown-content" id="control-dropdown">
                                <button id="pause-resume-btn" class="dropdown-item" disabled>
                                    <i class="fas fa-pause"></i> Pause System
                                </button>
                                <button id="stop-btn" class="dropdown-item" disabled>
                                    <i class="fas fa-stop"></i> Stop System
                                </button>
                                <hr class="dropdown-divider">
                                <button id="kill-rogue-btn" class="dropdown-item emergency-item">
                                    <i class="fas fa-skull"></i> Kill Rogue Processes
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="status-indicator">
                        <span id="connection-status" class="status-badge connecting">
                            <i class="fas fa-circle"></i> Connecting...
                        </span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Dashboard -->
        <main class="main-content">
            <!-- Pipeline Status Cards -->
            <section class="status-cards">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-play-circle"></i> System Status</h3>
                    </div>
                    <div class="card-content">
                        <div class="metric" id="system-status">Idle</div>
                        <div class="metric-label">Current State</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-lightbulb"></i> Ideas</h3>
                    </div>
                    <div class="card-content">
                        <div class="metric" id="total-ideas">0</div>
                        <div class="metric-label">Generated</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-project-diagram"></i> Projects</h3>
                    </div>
                    <div class="card-content">
                        <div class="metric" id="total-projects">0</div>
                        <div class="metric-label">Active</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-trophy"></i> Completed</h3>
                    </div>
                    <div class="card-content">
                        <div class="metric" id="completed-projects">0</div>
                        <div class="metric-label">Projects Done</div>
                    </div>
                </div>
            </section>





            <!-- Agent Status Section -->
            <section class="agent-status-section">
                <h2><i class="fas fa-robot"></i> Live Agent Status</h2>
                <div class="agent-grid">
                    <div class="agent-card" id="hypothesis_maker">
                        <div class="agent-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div class="agent-info">
                            <h3>Hypothesis Maker</h3>
                            <div class="agent-status idle">Idle</div>
                            <div class="agent-details">
                                <span class="current-project">Project: None</span>
                                <span class="last-activity">Last active: Never</span>
                                <span class="execution-stats">0 executions</span>
                            </div>
                        </div>
                    </div>

                    <div class="agent-card" id="reviewer">
                        <div class="agent-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <div class="agent-info">
                            <h3>Reviewer</h3>
                            <div class="agent-status idle">Idle</div>
                            <div class="agent-details">
                                <span class="current-project">Project: None</span>
                                <span class="last-activity">Last active: Never</span>
                                <span class="execution-stats">0 executions</span>
                            </div>
                        </div>
                    </div>

                    <div class="agent-card" id="experiment_designer">
                        <div class="agent-icon">
                            <i class="fas fa-flask"></i>
                        </div>
                        <div class="agent-info">
                            <h3>Experiment Designer</h3>
                            <div class="agent-status idle">Idle</div>
                            <div class="agent-details">
                                <span class="current-project">Project: None</span>
                                <span class="last-activity">Last active: Never</span>
                                <span class="execution-stats">0 executions</span>
                            </div>
                        </div>
                    </div>

                    <div class="agent-card" id="experimenter">
                        <div class="agent-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="agent-info">
                            <h3>Experimenter</h3>
                            <div class="agent-status idle">Idle</div>
                            <div class="agent-details">
                                <span class="current-project">Project: None</span>
                                <span class="last-activity">Last active: Never</span>
                                <span class="execution-stats">0 executions</span>
                            </div>
                        </div>
                    </div>

                    <div class="agent-card" id="peer_reviewer">
                        <div class="agent-icon">
                            <i class="fas fa-user-check"></i>
                        </div>
                        <div class="agent-info">
                            <h3>Peer Reviewer</h3>
                            <div class="agent-status idle">Idle</div>
                            <div class="agent-details">
                                <span class="current-project">Project: None</span>
                                <span class="last-activity">Last active: Never</span>
                                <span class="execution-stats">0 executions</span>
                            </div>
                        </div>
                    </div>

                    <div class="agent-card" id="reporter">
                        <div class="agent-icon">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div class="agent-info">
                            <h3>Reporter</h3>
                            <div class="agent-status idle">Idle</div>
                            <div class="agent-details">
                                <span class="current-project">Project: None</span>
                                <span class="last-activity">Last active: Never</span>
                                <span class="execution-stats">0 executions</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Pipeline Start Section -->
            <section class="pipeline-start-section">
                <div class="control-card">
                    <div class="card-header">
                        <h3><i class="fas fa-play"></i> Start Continuous Research</h3>
                    </div>
                    <div class="card-content">
                        <form id="continuous-form" class="continuous-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="domain-tags">Research Domains:</label>
                                    <input type="text" id="domain-tags" placeholder="stellar evolution, galactic dynamics" required>
                                </div>
                                <div class="form-group">
                                    <label for="n-hypotheses">Target Completions:</label>
                                    <input type="number" id="n-hypotheses" min="1" max="10" value="3" required>
                                </div>
                                <div class="form-group">
                                    <label for="ambition-level">Ambition Level:</label>
                                    <select id="ambition-level" required>
                                        <option value="incremental">Incremental</option>
                                        <option value="significant" selected>Significant</option>
                                        <option value="paradigm-shifting">Paradigm-Shifting</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn-primary" id="start-continuous-btn">
                                    <i class="fas fa-play"></i> Start Research
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>

            <!-- Content Tabs -->
                <div class="tab-buttons">
                    <button class="tab-button active" data-tab="ideas">
                        <i class="fas fa-lightbulb"></i> Recent Ideas
                    </button>
                    <button class="tab-button" data-tab="projects">
                        <i class="fas fa-project-diagram"></i> Active Projects
                    </button>
                    <button class="tab-button" data-tab="completed">
                        <i class="fas fa-trophy"></i> Complete Projects
                    </button>
                    <button class="tab-button" data-tab="statistics">
                        <i class="fas fa-chart-bar"></i> Statistics
                    </button>
                </div>

                <!-- Ideas Tab -->
                <div class="tab-content active" id="ideas-tab">
                    <div class="table-controls">
                        <div class="control-group">
                            <label for="ideas-search">Search:</label>
                            <input type="text" id="ideas-search" placeholder="Search ideas..." class="search-input">
                        </div>
                        <div class="control-group">
                            <label for="ideas-status-filter">Status:</label>
                            <select id="ideas-status-filter" class="filter-select">
                                <option value="all">All Statuses</option>
                                <option value="Proposed">Proposed</option>
                                <option value="Under Review">Under Review</option>
                                <option value="Approved">Approved</option>
                                <option value="Needs Revision">Needs Revision</option>
                                <option value="Rejected">Rejected</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label for="ideas-sort">Sort by:</label>
                            <select id="ideas-sort" class="sort-select">
                                <option value="created_at">Created Date</option>
                                <option value="title">Title</option>
                                <option value="status">Status</option>
                                <option value="total_score">Score</option>
                            </select>
                            <select id="ideas-sort-order" class="sort-order-select">
                                <option value="desc">Descending</option>
                                <option value="asc">Ascending</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label for="ideas-limit">Show:</label>
                            <select id="ideas-limit" class="limit-select">
                                <option value="20">20 rows</option>
                                <option value="50">50 rows</option>
                                <option value="100">100 rows</option>
                            </select>
                        </div>
                    </div>
                    <div class="data-table-container">
                        <table class="data-table sortable">
                            <thead>
                                <tr>
                                    <th class="sortable-header" data-column="title">
                                        Title <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable-header" data-column="status">
                                        Status <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable-header" data-column="current_agent">
                                        Current Agent <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable-header" data-column="total_score">
                                        Score <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable-header" data-column="domain_tags">
                                        Domain Tags <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="sortable-header" data-column="created_at">
                                        Created <i class="fas fa-sort"></i>
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="ideas-table-body">
                                <tr>
                                    <td colspan="6" class="loading">Loading ideas...</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="table-info">
                            <span id="ideas-table-info">Showing 0 of 0 ideas</span>
                        </div>
                    </div>
                </div>

                <!-- Projects Tab -->
                <div class="tab-content" id="projects-tab">
                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Project Path</th>
                                    <th>Maturity</th>
                                    <th>Ready Checks</th>
                                    <th>Execution Start</th>
                                    <th>Created</th>
                                </tr>
                            </thead>
                            <tbody id="projects-table-body">
                                <tr>
                                    <td colspan="5" class="loading">Loading projects...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Statistics Tab -->
                <div class="tab-content" id="statistics-tab">
                    <div class="statistics-grid">
                        <div class="stat-card">
                            <h3>Idea Status Distribution</h3>
                            <canvas id="idea-status-chart"></canvas>
                        </div>
                        <div class="stat-card">
                            <h3>Project Maturity Distribution</h3>
                            <canvas id="project-maturity-chart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Complete Projects Tab -->
                <div class="tab-content" id="completed-tab">
                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Project Path</th>
                                    <th>Has Paper</th>
                                    <th>Has Peer Review</th>
                                    <th>Paper</th>
                                    <th>Completed</th>
                                </tr>
                            </thead>
                            <tbody id="completed-table-body">
                                <tr>
                                    <td colspan="6" class="loading">Loading completed projects...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </main>

        <!-- Activity Log -->
        <aside class="activity-log">
            <h3><i class="fas fa-list"></i> Activity Log</h3>
            <div id="activity-list" class="activity-list">
                <div class="activity-item">
                    <div class="activity-time">System initialized</div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Idea Detail Modal -->
    <div id="idea-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Idea Details</h2>
                <button class="modal-close" id="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="idea-detail-grid">
                    <div class="detail-section">
                        <h3><i class="fas fa-info-circle"></i> Basic Information</h3>
                        <div class="detail-item">
                            <span class="label">ID:</span>
                            <span class="value" id="modal-idea-id">-</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">Status:</span>
                            <span class="value" id="modal-status">-</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">Created:</span>
                            <span class="value" id="modal-created">-</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">Domain Tags:</span>
                            <span class="value" id="modal-domains">-</span>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h3><i class="fas fa-chart-line"></i> Scores & Metrics</h3>
                        <div class="detail-item">
                            <span class="label">Total Score:</span>
                            <span class="value" id="modal-total-score">-</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">Novelty Score:</span>
                            <span class="value" id="modal-novelty-score">-</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">Impact Score:</span>
                            <span class="value" id="modal-impact-score">-</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">Feasibility Score:</span>
                            <span class="value" id="modal-feasibility-score">-</span>
                        </div>

                    </div>

                    <div class="detail-section full-width">
                        <h3><i class="fas fa-lightbulb"></i> Hypothesis</h3>
                        <div class="detail-text" id="modal-hypothesis">-</div>
                    </div>

                    <div class="detail-section full-width">
                        <h3><i class="fas fa-book"></i> Rationale</h3>
                        <div class="detail-text" id="modal-rationale">-</div>
                    </div>

                    <div class="detail-section">
                        <h3><i class="fas fa-database"></i> Required Data</h3>
                        <ul class="detail-list" id="modal-required-data">
                            <li>No data specified</li>
                        </ul>
                    </div>

                    <div class="detail-section">
                        <h3><i class="fas fa-tools"></i> Methods</h3>
                        <ul class="detail-list" id="modal-methods">
                            <li>No methods specified</li>
                        </ul>
                    </div>

                    <div class="detail-section full-width" id="modal-notes-section" style="display: none;">
                        <h3><i class="fas fa-sticky-note"></i> Reviewer Notes</h3>
                        <div class="detail-text" id="modal-notes">-</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="modal-close-footer-btn">Close</button>
                <button class="btn btn-primary" id="modal-edit-btn" style="display: none;">Edit Idea</button>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
